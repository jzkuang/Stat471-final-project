graph <- ggplot() +
geom_point(aes(x=avg_MannAlk, y=time))
graph
graph <- ggplot() +
geom_point(aes(x=avg_MannAlk, y=time)) +
theme_bw()
ggplot() +
geom_point(aes(x=avg_MannAlk, y=time)) +
theme_bw()
ggplot() +
geom_point(aes(y=avg_MannAlk, x=time)) +
theme_bw()
ggplot() +
geom_point(aes(y=avg_MannAlk, x=time)) +
labs(x="Time (days)", y="MFI")
ggplot() +
geom_point(aes(y=avg_MannAlk, x=time)) +
labs(x="Time (days)", y="MFI")+
theme_bw()
ggplot() +
geom_point(aes(y=avg_MannAlk, x=time)) +
xlim(0,10)+
labs(x="Time (days)", y="MFI")+
theme_bw()
ggplot() +
geom_point(aes(y=avg_MannAlk, x=time)) +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
ggplot(aes(y=avg_MannAlk, x=time)) +
geom_point() +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
ggplot(aes(y=avg_MannAlk, x=time)) +
geom_point() +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
ggplot() +
geom_point(aes(y=avg_MannAlk, x=time)) +
geo
ggplot() +
geom_point(aes(y=avg_MannAlk, x=time)) +
geom_line(aes(y=avg_MannAlk, x=time)) +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
ggplot(aes(y=avg_MannAlk, x=time)) +
geom_point(aes(y=avg_MannAlk, x=time)) +
geom_line(aes(y=avg_MannAlk, x=time)) +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
tibble = tibble(avg_MannAlk, time)
tibble = table(avg_MannAlk, time)
table(avg_MannAlk, time)
tibble = table(MFI = avg_MannAlk, time = time)
table(MFI = avg_MannAlk, time = time)
data.frame(MFI = avg_MannAlk, time = time)
tibble <- ggplot() +
geom_point(aes(y=avg_MannAlk, x=time)) +
geom_line(aes(y=avg_MannAlk, x=time)) +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
ggplot(data=tibble, aes(y=avg_MannAlk, x=time)) +
geom_point() +
geom_line() +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
tibble = data.frame(MFI = avg_MannAlk, time = time)
ggplot(data=tibble, aes(y=avg_MannAlk, x=time)) +
geom_point() +
geom_line() +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
table = data.frame(MFI = avg_MannAlk, time = time)
ggplot(table, aes(y=avg_MannAlk, x=time)) +
geom_point() +
geom_line() +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
ggplot(table, aes(y=avg_MannAlk, x=time)) +
geom_point() +
geom_line() +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
ggplot(washout_data, aes(y=avg_MannAlk, x=time)) +
geom_point() +
geom_line() +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
washout_data = data.frame(MFI = avg_MannAlk, time = time)
ggplot(washout_data, aes(y=avg_MannAlk, x=time)) +
geom_point() +
geom_line() +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
control = c(569,965,201,432,629)
washout_data = data.frame(MFI = avg_MannAlk, Control = control, time = time)
washout_data = data.frame(MannAlk = avg_MannAlk, Control = control, time = time)
ggplot(washout_data, aes(x=time)) +
geom_point(aes(y=MannAlk)) +
geom_line(aes(y=MannAlk)) +
geom_point(aes(y=Control)) +
geom_line(aes(y=Control)) +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
ggplot(washout_data, aes(x=time, colour=class)) +
geom_point(aes(y=MannAlk)) +
geom_line(aes(y=MannAlk)) +
geom_point(aes(y=Control)) +
geom_line(aes(y=Control)) +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
ggplot(washout_data, aes(x=time, colour=red)) +
geom_point(aes(y=MannAlk)) +
geom_line(aes(y=MannAlk)) +
geom_point(aes(y=Control)) +
geom_line(aes(y=Control)) +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
ggplot(washout_data, aes(x=time, colour="red")) +
geom_point(aes(y=MannAlk)) +
geom_line(aes(y=MannAlk)) +
geom_point(aes(y=Control)) +
geom_line(aes(y=Control)) +
xlim(0,10)+ ylim(0,45000)+
labs(x="Time (days)", y="MFI")+
theme_bw()
options(scipen = 0, digits = 3)  # controls number of significant digits printed
library(rpart)         # to train decision trees
library(rpart.plot)    # to plot decision trees
library(randomForest)  # random forests
library(gbm)           # boosting
library(rpart)         # to train decision trees
library(rpart.plot)    # to plot decision trees
library(randomForest)  # random forests
library(gbm)           # boosting
library(tidyverse)     # tidyverse
spam_data = read_tsv("../../data/spam_data.tsv")
# extract training data
spam_train = spam_data %>%
filter(test == 0) %>%
select(-test)
# extract test data
spam_test = spam_data %>%
filter(test == 1) %>%
select(-test)
spam_train
spam_train %>%
summarise(mean(sp))
View(spam_train)
spam_train
View(spam_data)
View(spam_train)
spam_train %>%
summarise(mean(spam))
?summarise_at
avg_word_freq = spam_train %>%
summarise_at(vars(starts_with("word_freq")))
avg_word_freq = spam_train %>%
summarise_at(vars(starts_with("word_freq")), funs=a)
avg_word_freq = spam_train %>%
summarise_at(vars(starts_with("word_freq")), funs="a")
avg_word_freq = spam_train %>%
summarise_at(vars(starts_with("word_freq")), funs(mean))
avg_word_freq = spam_train %>%
summarise_at(vars(starts_with("word_freq")), funs(n(), mean))
avg_word_freq
avg_word_freq = spam_train %>%
summarise_at(vars(starts_with("word_freq")), funs(n(), mean, median))
avg_word_freq
avg_word_freq = spam_train %>%
summarise_at(vars(starts_with("word_freq")), funs(mean, median))
avg_word_freq
avg_word_freq = spam_train %>%
summarise_at(vars(starts_with("word_freq")), funs(mean))
avg_word_freq
avg_word_freq_long = avg_word_freq %>%
pivot_longer()
avg_word_freq_long = avg_word_freq %>%
pivot_longer(names_to = "word", values_to="avg_freq")
avg_word_freq_long = avg_word_freq %>%
pivot_longer(1,names_to = "word", values_to="avg_freq")
avg_word_freq_long
avg_word_freq_long = avg_word_freq %>%
pivot_longer(cols = starts_with("word_freq"),names_to = "word", values_to="avg_freq")
avg_word_freq_long
avg_word_freq_long = avg_word_freq %>%
pivot_longer(cols = everything(), names_prefix = "word_freq_",names_to = "word", values_to="avg_freq")
avg_word_freq_long
avg_word_freq_long %>%
ggplot(aes(x=word,y=avg_freq)) +
geom_histogram()
avg_word_freq_long %>%
ggplot(aes(x=word)) +
geom_histogram()
avg_word_freq_long %>%
ggplot(aes(y=avg_freq)) +
geom_histogram()
avg_word_freq_long %>%
ggplot(aes(x=avg_freq)) +
geom_histogram()
avg_word_freq_long %>%
ggplot(aes(x=avg_freq)) +
geom_histogram(binwidth=1)
avg_word_freq_long %>%
ggplot(aes(x=avg_freq)) +
geom_histogram(binwidth=0.5)
avg_word_freq_long %>%
ggplot(aes(x=avg_freq)) +
geom_histogram(binwidth=0.1)
avg_word_freq_long %>%
ggplot(aes(x=avg_freq)) +
geom_histogram(binwidth=0.2)
avg_word_freq_long %>%
ggplot(aes(x=avg_freq)) +
geom_histogram(binwidth=0.1)
avg_word_freq_long %>%
arrange()
avg_word_freq_long %>%
arrange(avg_freq)
avg_word_freq_long %>%
arrange(desc(avg_freq))
avg_word_freq_long %>%
arrange(desc(avg_freq)) %>%
top_n(3)
View(spam_data)
avg_word_freq_long %>%
ggplot(aes(x=avg_freq)) +
geom_histogram(binwidth=0.1)
spam_train
avg_word_freq_spam = spam_train %>%
filter(spam==1) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean))
spam_train %>%
filter(spam==1)
avg_word_freq_spam = spam_train %>%
filter(spam==0) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean))
avg_word_freq_nospam = spam_train %>%
filter(spam==0) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean))
avg_word_freq_spam = spam_train %>%
filter(spam==1) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean))
avg_word_freq_spam = spam_train %>%
filter(spam==1) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = everything(), names_prefix = "word_freq_",names_to = "word", values_to="avg_freq")
avg_word_freq_spam
avg_word_freq_nospam = spam_train %>%
filter(spam==0) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = everything(),
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq")
avg_word_freq_nospam
avg_word_freq_nospam = spam_train %>%
filter(spam==0) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = everything(),
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq") %>%
inner_join(avg_word_freq_spam)
avg_word_freq_nospam
avg_word_freq_nospam = spam_train %>%
filter(spam==0) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = everything(),
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq") %>%
inner_join(avg_word_freq_spam)
spam_train %>%
filter(spam==0) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = everything(),
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq")
avg_word_freq_nospam = spam_train %>%
filter(spam==0) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = everything(),
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq") %>%
full_join(avg_word_freq_spam)
avg_word_freq_nospam
avg_word_freq_nospam
avg_word_freq_spam
avg_word_freq_nospam = spam_train %>%
filter(spam==0) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = everything(),
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq") %>%
full_join(avg_word_freq_spam)
avg_word_freq_nospam = spam_train %>%
filter(spam==0) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = everything(),
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq") %>%
full_join(avg_word_freq_spam, by=c("word"))
avg_word_freq_nospam
?full_join
spam_train %>%
filter(spam==0) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = everything(),
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq")
avg_word_freq_nospam
avg_word_freq_nospam = spam_train %>%
filter(spam==0) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = everything(),
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq") %>%
full_join(avg_word_freq_spam, by=c("word")) %>%
rename(avg_freq_spam = avg_freq.x)
avg_word_freq_nospam
avg_word_freq_nospam = spam_train %>%
filter(spam==0) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = everything(),
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq") %>%
full_join(avg_word_freq_spam, by=c("word")) %>%
rename(avg_freq_nospam = avg_freq.x, avg_freq_spam = avg_freq.y)
avg_word_freq_nospam
avg_word_freq_nospam = spam_train %>%
filter(spam==0) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = everything(),
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq")
avg_word_freq_diff = avg_word_freq_nospam %>%
full_join(avg_word_freq_spam, by=c("word")) %>%
rename(avg_freq_nospam = avg_freq.x, avg_freq_spam = avg_freq.y)
avg_word_freq_diff
avg_word_freq_spam
avg_word_freq_diff
avg_word_freq_diff = avg_word_freq_nospam %>%
full_join(avg_word_freq_spam, by=c("word")) %>%
rename(avg_freq_nospam = avg_freq.x, avg_freq_spam = avg_freq.y) %>%
mutate(difference = avg_freq_spam - avg_freq_nospam)
avg_word_freq_diff
diff_avg_word_freq = avg_word_freq_nospam %>%
full_join(avg_word_freq_spam, by=c("word")) %>%
rename(avg_freq_nospam = avg_freq.x, avg_freq_spam = avg_freq.y) %>%
mutate(difference = avg_freq_spam - avg_freq_nospam) %>%
select(word, difference)
diff_avg_word_freq
diff_avg_word_freq = avg_word_freq_nospam %>%
full_join(avg_word_freq_spam, by=c("word")) %>%
rename(avg_freq_nospam = avg_freq.x, avg_freq_spam = avg_freq.y) %>%
mutate(diff_avg_freq = avg_freq_spam - avg_freq_nospam) %>%
select(word, diff_avg_freq)
diff_avg_word_freq
diff_avg_word_freq %>%
ggplot(aes(x=diff_avg_freq)) +
geom_histogram()
diff_avg_word_freq %>%
arrange(desc(diff_avg_freq)) +
top_n(3)
diff_avg_word_freq %>%
arrange(desc(diff_avg_freq))
diff_avg_word_freq %>%
arrange(desc(diff_avg_freq)) %>%
top_n(3)
diff_avg_word_freq %>%
arrange(diff_avg_freq) %>%
top_n(3)
diff_avg_word_freq %>%
arrange(diff_avg_freq)
diff_avg_word_freq %>%
arrange(diff_avg_freq) %>%
top_n(3)
diff_avg_word_freq %>%
arrange(diff_avg_freq) %>%
bottom_n(3)
diff_avg_word_freq %>%
arrange(diff_avg_freq) %>%
bot_n(3)
diff_avg_word_freq %>%
arrange(diff_avg_freq)
diff_avg_word_freq %>%
arrange(desc(diff_avg_freq)) %>%
top_n(-3)
spam_train%>%
mutate(spam_true = (spam == 1))
spam_train%>%
mutate(spam_true = (spam == 1)) %>%
pivot_wider(names_from = spam, values_to= spam_true)
spam_train%>%
mutate(spam_true = (spam == 1)) %>%
pivot_wider(names_from = spam, values_from= spam_true)
spam_train%>%
mutate(spam_true = (spam == 1)) %>%
pivot_wider(names_from = spam_true, values_from= spam)
spam_train%>%
group_by(spam)
spam_train%>%
group_by(spam) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean))
spam_train%>%
group_by(spam) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_wider(names_from=spam, values_from=-spam)
spam_train%>%
group_by(spam) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean))
spam_train%>%
group_by(spam) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_wider(names_from=spam, values_from=word_freq_make)
spam_train%>%
group_by(spam) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean))
spam_train%>%
group_by(spam) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = everything(),
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq")
spam_train%>%
group_by(spam) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = -spam,
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq")
spam_train%>%
group_by(spam) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = -spam,
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq") %>%
pivot_wider(names_from=spam, values_from=avg_freq)
spam_train%>%
group_by(spam) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = -spam,
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq") %>%
pivot_wider(names_from=spam, values_from=avg_freq) %>%
mutate(diff_avg_freq = "1" - "0")
spam_train%>%
group_by(spam) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = -spam,
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq") %>%
pivot_wider(names_from=spam, values_from=avg_freq) %>%
rename(spam = "1", nospam = "0")
mutate(diff_avg_freq = spam - nospam)
spam_train%>%
group_by(spam) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = -spam,
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq") %>%
pivot_wider(names_from=spam, values_from=avg_freq) %>%
rename(spam = "1", nospam = "0") %>%
mutate(diff_avg_freq = spam - nospam)
spam_train%>%
group_by(spam) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = -spam,
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq") %>%
pivot_wider(names_from=spam, values_from=avg_freq) %>%
rename(spam = "1", nospam = "0") %>%
mutate(diff_avg_freq = spam - nospam) %>%
select(-spam, -nospam)
spam_train%>%
group_by(spam) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = -spam,
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq") %>%
pivot_wider(names_from=spam, values_from=avg_freq) %>%
rename(spam = "1", nospam = "0") %>%
mutate(diff_avg_freq = spam - nospam) %>%
select(-spam, -nospam) %>%
arrange(diff_avg_freq)
diff_avg_word_freq = spam_train%>%
group_by(spam) %>%
summarise_at(vars(starts_with("word_freq")), funs(mean)) %>%
pivot_longer(cols = -spam,
names_prefix = "word_freq_",
names_to = "word", values_to="avg_freq") %>%
pivot_wider(names_from=spam, values_from=avg_freq) %>%
rename(spam = "1", nospam = "0") %>%
mutate(diff_avg_freq = spam - nospam) %>%
select(-spam, -nospam)
diff_avg_word_freq %>%
arrange(desc(diff_avg_freq)) %>%
top_n(-3)
options(scipen = 0, digits = 3)  # controls number of significant digits printed
library(keras)         # to train neural networks
setwd("~/Stat471-final-project/code")
